---

- debug:
    var: stackdriver

- include_tasks: configure_logging_agent.yml
  vars:
    stackdriver: 'Hello world'

#  vars:
#    stackdriver:
#      config: |
#        <source>
#          @type tail
#          <parse>
#            @type regexp
#            expression /^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3})\s+(?<level>[A-Z]+)\s+(?<message>.*)$/
#            time_format %Y-%m-%d %H:%M:%S,%L
#          </parse>
#          path /var/log/unattended-upgrades/unattended-upgrades.log
#          pos_file /var/lib/google-fluentd/pos/unattended-upgrades.pos
#          tag unattended-upgrades
#        </source>
#        <filter unattended-upgrades>
#          @type record_transformer
#          enable_ruby
#          renew_record true
#          keep_keys level
#          <record>
#            hostname ${hostname}
#            message ${hostname + " " + record["message"]}
#          </record>
#        </filter>
#      filename: unattended-upgrades
